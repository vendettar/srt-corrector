# SRT字幕修正工具 - 使用指南

## 📌 重要说明

**这个工具是完全通用的**，可以用于任何SRT和TXT文件对，不仅仅是当前的"Steve Jobs - 02"文件。

---

## 🚀 快速开始

### 1️⃣ 基本使用（任意文件）

```bash
python3 srt_corrector_final.py "你的文件.srt" "你的参考文本.txt"
```

**输出：** `你的文件_corrected_final.srt`

---

### 2️⃣ 指定输出文件名

```bash
python3 srt_corrector_final.py "输入.srt" "参考.txt" "自定义输出名.srt"
```

**输出：** `自定义输出名.srt`

---

### 3️⃣ 调整匹配阈值

```bash
# 更严格（0.7）
python3 srt_corrector_final.py "输入.srt" "参考.txt" "输出.srt" 0.7

# 更宽松（0.6）
python3 srt_corrector_final.py "输入.srt" "参考.txt" "输出.srt" 0.6
```

---

## 📂 实际应用场景

### 场景1：处理有声书的其他章节

```bash
# 第3章
python3 srt_corrector_final.py "Steve Jobs - 03.mp3.srt" "Steve Jobs - 03.txt"

# 第4章
python3 srt_corrector_final.py "Steve Jobs - 04.mp3.srt" "Steve Jobs - 04.txt"

# 第5章
python3 srt_corrector_final.py "Steve Jobs - 05.mp3.srt" "Steve Jobs - 05.txt"
```

---

### 场景2：处理不同的书籍

```bash
# 处理《1984》
python3 srt_corrector_final.py "1984_audio.srt" "1984_book.txt"

# 处理《哈利波特》
python3 srt_corrector_final.py "Harry_Potter_Ch1.srt" "Harry_Potter_Ch1.txt"

# 处理中文书籍
python3 srt_corrector_final.py "三体.srt" "三体.txt"
```

---

### 场景3：批量处理多个文件

创建一个批处理脚本：

**batch_process.sh**
```bash
#!/bin/bash

# 处理第1-10章
for i in {01..10}; do
    echo "处理第 $i 章..."
    python3 srt_corrector_final.py \
        "Steve Jobs - ${i}.mp3.srt" \
        "Steve Jobs - ${i}.txt"
done

echo "全部完成！"
```

运行：
```bash
chmod +x batch_process.sh
./batch_process.sh
```

---

## 📋 文件要求

### ✅ SRT文件要求

1. **标准SRT格式**
   ```
   1
   00:00:00,100 --> 00:00:06,299
   文本内容

   2
   00:00:06,299 --> 00:00:09,980
   下一段文本
   ```

2. **UTF-8编码**（必须）
3. **任何语言**（英文、中文、日文等）

---

### ✅ TXT文件要求

1. **UTF-8编码**（必须）
2. **包含准确的参考文本**
3. **最好包含完整的标点符号**
4. **内容顺序应与SRT大致对应**

---

## 💡 常见问题

### Q1: 可以用于中文字幕吗？
**答：** 可以！脚本支持任何Unicode字符。

```bash
python3 srt_corrector_final.py "中文字幕.srt" "中文原文.txt"
```

---

### Q2: 如果SRT和TXT内容顺序不完全一致怎么办？
**答：**
- 如果顺序**大致一致**：使用标准版 `srt_corrector_final.py`
- 如果顺序**完全一致**：使用严格版 `srt_corrector_strict.py`（修正率更高）

---

### Q3: 修正率不理想怎么办？
**答：** 尝试调整阈值

```bash
# 修正率太低 → 降低阈值
python3 srt_corrector_final.py "input.srt" "ref.txt" "output.srt" 0.55

# 出现误匹配 → 提高阈值
python3 srt_corrector_final.py "input.srt" "ref.txt" "output.srt" 0.75
```

---

### Q4: TXT文件太大会影响性能吗？
**答：** 不会。算法使用位置追踪，即使TXT文件有几百MB也能快速处理。

---

### Q5: 可以处理多个音频文件的字幕吗？
**答：** 可以！只要每个SRT都有对应的TXT文件即可。建议使用批处理脚本。

---

## 🔧 两个版本的选择

### 标准版（推荐）
```bash
python3 srt_corrector_final.py "input.srt" "ref.txt"
```
- ✅ 更安全，适合大多数场景
- ✅ 默认阈值 0.65
- ✅ 防止误匹配

### 严格版（高修正率）
```bash
python3 srt_corrector_strict.py "input.srt" "ref.txt"
```
- ✅ 修正率更高（约提高1-2%）
- ✅ 默认阈值 0.50
- ✅ 适合SRT和TXT顺序严格一致的情况

---

## 📊 性能数据（参考）

| 文件大小 | 字幕条数 | 处理时间 | 修正率 |
|---------|---------|---------|--------|
| 70KB SRT | 572条 | ~5秒 | 66.6% |
| 200KB SRT | 1500条 | ~15秒 | 预计65-70% |
| 500KB SRT | 4000条 | ~40秒 | 预计65-70% |

---

## 🎯 完整示例

### 示例1：处理单个文件
```bash
cd "/path/to/your/files"
python3 /path/to/srt_corrector_final.py "chapter1.srt" "chapter1.txt"
```

### 示例2：处理并指定输出位置
```bash
python3 srt_corrector_final.py \
    "original/chapter1.srt" \
    "text/chapter1.txt" \
    "corrected/chapter1_fixed.srt"
```

### 示例3：使用不同阈值处理多个文件
```bash
# 第1章用默认阈值
python3 srt_corrector_final.py "ch1.srt" "ch1.txt"

# 第2章质量差，降低阈值
python3 srt_corrector_final.py "ch2.srt" "ch2.txt" "ch2_out.srt" 0.55

# 第3章质量好，提高阈值
python3 srt_corrector_final.py "ch3.srt" "ch3.txt" "ch3_out.srt" 0.75
```

---

## 📝 注意事项

1. **文件路径**：如果文件名包含空格，记得用引号包裹
   ```bash
   python3 srt_corrector_final.py "Steve Jobs - 02.srt" "Steve Jobs - 02.txt"
   ```

2. **编码问题**：确保SRT和TXT都是UTF-8编码
   - Mac/Linux：通常默认就是UTF-8
   - Windows：可能需要转换编码

3. **文件权限**：确保脚本有读取SRT和TXT文件的权限

4. **输出覆盖**：如果输出文件已存在，会被覆盖（无警告）

---

## 🆘 故障排除

### 问题：提示"文件不存在"
**解决：** 检查文件路径是否正确
```bash
# 查看当前目录
ls -la

# 使用绝对路径
python3 srt_corrector_final.py "/完整/路径/to/file.srt" "/完整/路径/to/file.txt"
```

### 问题：修正率为0%
**解决：**
1. 检查TXT内容是否与SRT对应
2. 尝试降低阈值到0.5
3. 检查文件编码是否为UTF-8

### 问题：输出乱码
**解决：** 文件编码问题
```bash
# 检查文件编码
file -I "your_file.srt"

# 转换编码（如果需要）
iconv -f GBK -t UTF-8 input.txt > output.txt
```

---

## 🎓 总结

这个工具是**完全通用的**，可以用于：
- ✅ 任何SRT字幕文件
- ✅ 任何TXT参考文本
- ✅ 任何语言（英文、中文、日文等）
- ✅ 任何主题（有声书、电影、讲座等）
- ✅ 批量处理多个文件

**唯一要求：**
1. SRT和TXT内容大致对应
2. 文件都是UTF-8编码
3. SRT遵循标准格式

---

需要帮助？查看 README.md 或运行：
```bash
python3 srt_corrector_final.py
```
